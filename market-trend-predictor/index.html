<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Market Trend Predictor and Recommendation System</title>
		<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
		<style>
			body {
				font-family: Arial, sans-serif;
				margin: 0;
				padding: 0;
				box-sizing: border-box;
			}
			nav.sidebar {
				width: 250px;
				background-color: #2c3e50;
				color: #ecf0f1;
				padding: 20px;
				height: 100vh;
				position: fixed;
				top: 0;
				left: 0;
				overflow-y: auto;
			}
			.sidebar .profile {
				display: flex;
				align-items: center;
				margin-bottom: 20px;
				border-bottom: 2px solid white;
				padding-bottom: 10px;
			}
			.sidebar .profile .profile-pic {
				width: 60px;
				height: 60px;
				border-radius: 50%;
				margin-right: 10px;
			}
			.sidebar .profile .username {
				font-size: 18px;
				font-weight: bold;
			}
			.sidebar .nav-items {
				list-style: none;
				padding: 0;
			}
			.sidebar .nav-items li {
				margin-bottom: 10px;
			}
			.sidebar .nav-items li a {
				color: #ecf0f1;
				text-decoration: none;
				font-size: 16px;
				display: block;
				padding: 10px;
				border-radius: 5px;
				transition: background-color 0.3s;
			}
			.sidebar .nav-items li a:hover {
				background-color: #34495e;
			}
			main.main-content {
				margin-left: 270px;
				width: calc(100% - 270px);
			}
			h1 {
				background-color: #2c3e50;
				padding: 15px;
				color: #ecf0f1;
				border-radius: 5px;
				margin: 0 0 20px;
				text-align: center;
			}
			.chart-wrapper {
				display: flex;
				flex-wrap: wrap;
				justify-content: space-between;
				margin-bottom: 40px;
				margin-left: 40px;
			}
			.chart-container-small,
			.chart {
				flex: 1 1 45%;
				margin: 10px;
			}
			.chart-container-small {
				max-width: 500px;
			}
			.chart h2 {
				text-align: center;
				margin-bottom: 20px;
			}
			.recommendations {
				margin-top: 40px;
				margin-left: 40px;
			}
			.recommendations h2 {
				color: #2c3e50;
				margin-bottom: 20px;
			}
			.recommendations ul {
				list-style: none;
				padding: 0;
			}
			.recommendations li {
				background-color: #ecf0f1;
				border: 1px solid #bdc3c7;
				border-radius: 5px;
				margin-bottom: 15px;
				padding: 15px;
				box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
			}
			.recommendations li h3 {
				margin: 0 0 10px;
				color: #2980b9;
			}
			.recommendations li p {
				margin: 0;
				color: #2c3e50;
			}
		</style>
	</head>
	<body>
		<nav class="sidebar">
			<div class="profile">
				<img
					src="https://upload.wikimedia.org/wikipedia/commons/2/2a/Standard_Bank_logo.png"
					alt="Profile Picture"
					class="profile-pic"
				/>
				<p class="username">Hack_Are_Tech</p>
			</div>
			<ul class="nav-items">
				<li><a href="#dashboard">Dashboard</a></li>
				<li><a href="#analytics">Analytics</a></li>
				<li><a href="#settings">Settings</a></li>
				<li><a href="#logout">Logout</a></li>
			</ul>
		</nav>
		<main class="main-content">
			<h1>Sentiment Analysis of Tweets</h1>
			<div class="chart-wrapper">
				<div class="chart-container-small">
					<canvas id="sentimentChart"></canvas>
				</div>
				<div class="chart-container-small">
					<canvas id="additionalPieChart"></canvas>
				</div>
			</div>

			<div class="chart-wrapper">
				<div class="chart">
					<h2>Market Value Over Time</h2>
					<canvas id="lineChart"></canvas>
				</div>
				<div class="chart">
					<h2>Number of Entries by Location</h2>
					<canvas id="barChart"></canvas>
				</div>
			</div>

			<div class="recommendations">
				<h2>Recommendations for Reducing Customer Frustrations</h2>
				<ul>
					<li>
						<h3>Improve Customer Service Responsiveness</h3>
						<p>
							Increase response speed with chatbots and ensure efficient
							handling by customer service representatives. Monitor and allocate
							resources based on peak times and types of queries.
						</p>
					</li>
					<li>
						<h3>Address Common Complaints</h3>
						<p>
							Analyze recurring complaints and update policies as needed.
							Provide proactive communication about known issues and their
							resolutions.
						</p>
					</li>
					<li>
						<h3>Enhance Digital Experience</h3>
						<p>
							Conduct usability testing and keep digital platforms updated.
							Implement feedback mechanisms for continuous improvement.
						</p>
					</li>
					<li>
						<h3>Personalize Customer Interactions</h3>
						<p>
							Personalize communication and solutions based on customer data.
							Use feedback to tailor improvements.
						</p>
					</li>
					<li>
						<h3>Enhance Transparency</h3>
						<p>
							Provide clear information about fees, changes, and disruptions.
							Offer educational resources for better understanding of services.
						</p>
					</li>
					<li>
						<h3>Implement Effective Complaint Resolution</h3>
						<p>
							Develop clear processes for resolving complaints. Empower staff to
							handle issues effectively and track resolution metrics.
						</p>
					</li>
					<li>
						<h3>Foster Positive Customer Engagement</h3>
						<p>
							Engage customers with initiatives and recognize loyal customers.
							Support community events aligned with customer interests.
						</p>
					</li>
					<li>
						<h3>Regularly Review and Update Policies</h3>
						<p>
							Review and update policies based on feedback and industry trends.
							Involve customers in policy development for better alignment with
							their needs.
						</p>
					</li>
				</ul>
			</div>
		</main>
		<script>
			async function fetchTweets() {
				try {
					const response = await fetch("/api/tweets");
					const data = await response.json();
					console.log("Tweets data:", data);
					renderSentimentChart(data);
					renderAdditionalPieChart(data);
				} catch (error) {
					console.error("Error fetching tweets:", error);
				}
			}

			async function fetchMarketData() {
				try {
					const response = await fetch("/api/market-data");
					const data = await response.json();
					console.log("Market data:", data);
					renderLineChart(data);
					renderBarChart(data);
				} catch (error) {
					console.error("Error fetching market data:", error);
				}
			}

			function renderSentimentChart(tweets) {
				const sentiments = { positive: 0, negative: 0, neutral: 0 };

				tweets.forEach((tweet) => {
					sentiments[tweet.sentiment]++;
				});

				const ctx = document.getElementById("sentimentChart").getContext("2d");
				new Chart(ctx, {
					type: "pie",
					data: {
						labels: ["Positive", "Negative", "Neutral"],
						datasets: [
							{
								label: "Sentiment",
								data: [
									sentiments.positive,
									sentiments.negative,
									sentiments.neutral,
								],
								backgroundColor: [
									"rgba(75, 192, 192, 0.6)",
									"rgba(255, 99, 132, 0.6)",
									"rgba(255, 206, 86, 0.6)",
								],
								borderWidth: 1,
							},
						],
					},
					options: {
						responsive: true,
					},
				});
			}

			function renderAdditionalPieChart(tweets) {
				const likes = { positive: 0, negative: 0, neutral: 0 };
				const retweets = { positive: 0, negative: 0, neutral: 0 };
				const replies = { positive: 0, negative: 0, neutral: 0 };

				tweets.forEach((tweet) => {
					likes[tweet.sentiment] += tweet.likes;
					retweets[tweet.sentiment] += tweet.retweets;
					replies[tweet.sentiment] += tweet.replies;
				});

				const ctx = document
					.getElementById("additionalPieChart")
					.getContext("2d");
				new Chart(ctx, {
					type: "pie",
					data: {
						labels: [
							"Positive Likes",
							"Negative Likes",
							"Neutral Likes",
							"Positive Retweets",
							"Negative Retweets",
							"Neutral Retweets",
							"Positive Replies",
							"Negative Replies",
							"Neutral Replies",
						],
						datasets: [
							{
								label: "Engagement",
								data: [
									likes.positive,
									likes.negative,
									likes.neutral,
									retweets.positive,
									retweets.negative,
									retweets.neutral,
									replies.positive,
									replies.negative,
									replies.neutral,
								],
								backgroundColor: [
									"rgba(75, 192, 192, 0.6)",
									"rgba(255, 99, 132, 0.6)",
									"rgba(255, 206, 86, 0.6)",
									"rgba(75, 192, 192, 0.6)",
									"rgba(255, 99, 132, 0.6)",
									"rgba(255, 206, 86, 0.6)",
									"rgba(75, 192, 192, 0.6)",
									"rgba(255, 99, 132, 0.6)",
									"rgba(255, 206, 86, 0.6)",
								],
								borderWidth: 1,
							},
						],
					},
					options: {
						responsive: true,
					},
				});
			}

			function renderLineChart(marketData) {
				const labels = marketData.map((entry) => entry.time);
				const data = marketData.map((entry) => entry.value);

				const ctx = document.getElementById("lineChart").getContext("2d");
				new Chart(ctx, {
					type: "line",
					data: {
						labels: labels,
						datasets: [
							{
								label: "Market Value",
								data: data,
								borderColor: "rgba(75, 192, 192, 1)",
								backgroundColor: "rgba(75, 192, 192, 0.2)",
								borderWidth: 1,
							},
						],
					},
					options: {
						responsive: true,
						scales: {
							x: {
								type: "time",
								time: {
									unit: "hour",
								},
							},
						},
					},
				});
			}

			function renderBarChart(marketData) {
				const locations = {};
				marketData.forEach((entry) => {
					if (!locations[entry.location]) {
						locations[entry.location] = 0;
					}
					locations[entry.location]++;
				});

				const labels = Object.keys(locations);
				const data = Object.values(locations);

				const ctx = document.getElementById("barChart").getContext("2d");
				new Chart(ctx, {
					type: "bar",
					data: {
						labels: labels,
						datasets: [
							{
								label: "Number of Entries",
								data: data,
								backgroundColor: "rgba(75, 192, 192, 0.6)",
								borderWidth: 1,
							},
						],
					},
					options: {
						responsive: true,
						scales: {
							x: {
								beginAtZero: true,
							},
						},
					},
				});
			}

			fetchTweets();
			fetchMarketData();
		</script>
	</body>
</html>
